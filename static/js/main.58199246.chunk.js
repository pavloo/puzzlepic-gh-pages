(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{185:function(e,t,n){},189:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),r=n(70),i=n.n(r),c=(n(84),n(11)),s=n(12),l=n(14),u=n(13),p=n(15),h=n(9),f=n(10);function d(){var e=Object(h.a)(["\n  border: 5px solid grey;\n  position: relative;\n  height: 100vh;\n  box-sizing: border-box;\n"]);return d=function(){return e},e}var v=f.a.div(d()),g=n(46),m=n(78);function b(){var e=Object(h.a)(["\n  display: none;\n"]);return b=function(){return e},e}var M=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).onLoad=function(e){var t=e.target,a=t.width,o=t.height;n.props.onUpdateDimensions&&n.props.onUpdateDimensions({width:a,height:o}),n.props.onLoad&&n.props.onLoad(e)},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return o.a.createElement("img",{className:this.props.className,src:this.props.src,onLoad:this.onLoad,alt:"Cannot load"})}}]),t}(a.Component),y=Object(f.a)(M)(b()),E=n(74),w=n.n(E),j=n(75),O=n.n(j),X=n(76),x=n.n(X),W=n(42),Y=n.n(W),k=n(43),I=n.n(k);function S(){var e=Object(h.a)(["\n  position: relative;\n"]);return S=function(){return e},e}function D(){var e=Object(h.a)(["\n  display: flex;\n  flex-flow: row nowrap;\n"]);return D=function(){return e},e}var P=f.a.div(D()),C={hole:1,nub:2,none:0},U=2;function R(e,t){for(var n=0;n<e.length;n++){var a=w()(e[n],function(e){return e.id===t});if(a)return a}}function L(e,t){for(var n=[],a=0;a<e.length;a++){var o=O()(e[a],function(e){return e.cluster===t});n=n.concat(o)}return n}function N(e,t){return e.reduce(function(e,n){return n[t]<e[t]?n:e},e[0])}function H(e,t){return e.reduce(function(e,n){return n[t]>e[t]?n:e},e[0])}var G=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onUpdateDimensions=function(e){for(var t=e.height,a=e.width,o=n.props,r=o.piecesX,i=o.piecesY,c=a/r,s=t/i,l=n.calculateScale(t,a),u=[],p=[],h=60*l,f=0,d=0,v=h,g=c*l,m=s*l,b=0;b<r*i;b++){var M=b%r*(g+h)+h;M=0===M?h:M,p.push({id:b+1,cluster:b+1,width:c,height:s,realHeight:m,realWidth:g,x:f,y:d,url:n.props.imageUrl,scale:l,pattern:{left:C.none,top:C.none,bottom:C.none,right:C.none},neighbours:{left:{},right:{},top:{},bottom:{}},left:M,top:v,approX:M,approY:v,beginMouseMove:!1}),(b+1)%r!==0?f+=c:(f=0,d+=s,v+=m+h,u.push(p),p=[])}n.setState({pieces:function(e){for(var t=0;t<e.length;t++)for(var n=e[t],a=0;a<n.length;a++){var o=Y()(e.length-1),r=Y()(n.length-1),i=e[t][a].top,c=e[t][a].left;e[t][a].top=e[o][r].top,e[t][a].left=e[o][r].left,e[t][a].approX=e[o][r].approX,e[t][a].approY=e[o][r].approY,e[o][r].top=i,e[o][r].left=c,e[o][r].approX=c,e[o][r].approY=i;var s=e[t][a];e[t][a]=e[o][r],e[o][r]=s}return e}(n.buildPattern(u))})},n.onMove=function(e){var t=e.id,a=e.deltaX,o=e.deltaY,r=n.state.pieces,i=function(e,t,n,a,o){for(var r=a,i=o,c=R(e,t),s=c.cluster,l=["left","right","top","bottom"],u=function(n){var a=l[n];c=R(e,t);var o=L(e,c.cluster).find(function(e){return!e.neighbours[a].has&&e.neighbours[a].id});if(!o)return"continue";var u=R(e,(c=o).neighbours[a].id),p=void 0,h=void 0;switch(a){case"left":return p=c.left-(u.left+u.realWidth),h=c.top-u.top,Math.abs(p)>15||Math.abs(h)>15?"continue":(c.neighbours.left.has=!0,r=c.approX-u.left-u.realWidth,i=c.approY-u.top,s=u.cluster,{v:[r,i,s,c]});case"right":return p=u.left-(c.left+c.realWidth),h=c.top-u.top,Math.abs(p)>15||Math.abs(h)>15?"continue":(c.neighbours.right.has=!0,r=c.approX-u.left+u.realWidth,i=c.approY-u.top,s=u.cluster,{v:[r,i,s,c]});case"top":return h=c.top-c.realHeight-u.top,p=u.left-c.left,Math.abs(p)>15||Math.abs(h)>15?"continue":(c.neighbours.top.has=!0,r=c.approX-u.left,i=c.approY-u.top-u.realHeight,s=u.cluster,{v:[r,i,s,c]});case"bottom":return h=u.top-c.top-c.realHeight,p=u.left-c.left,Math.abs(p)>15||Math.abs(h)>15?"continue":(c.neighbours.bottom.has=!0,r=c.approX-u.left,i=c.approY-u.top+u.realHeight,s=u.cluster,{v:[r,i,s,c]})}},p=0;p<l.length;p++){var h=u(p);switch(h){case"continue":continue;default:if("object"===typeof h)return h.v}}return[r,i,s,c]}(r,t,n.state.clusters,a,o),c=Object(m.a)(i,4),s=c[0],l=c[1],u=c[2],p=c[3],h=function(e,t,n,a,o,r){var i=L(e,R(e,t).cluster),c=N(i,"left"),s=N(i,"top"),l=H(i,"top"),u=H(i,"left");return c.left<0?[c.approX,a,!0]:s.top<0?[n,s.approY,!0]:u.left+u.realWidth>o?[u.approX-o+u.realWidth,a,!0]:l.top+l.realHeight>r?[n,l.approY-r+l.realHeight,!0]:[n,a,!1]}(r,t,s,l,n.containerRef.current.offsetWidth,window.innerHeight);s=h[0],l=h[1];for(var f=h[2],d=[],v=0;v<r.length;v++)for(var b=0;b<r[v].length;b++){var M=r[v][b];if(d[v]||(d[v]=[]),M.cluster!==p.cluster)d[v][b]=M;else{var y=M.approX-s,E=M.approY-l;d[v][b]=Object(g.a)({},M,{left:y,top:E,zIndex:9999})}}p.cluster!==u&&L(d,p.cluster).forEach(function(e){e.cluster=u,e.beginMouseMove=!1});f&&L(d,p.cluster).forEach(function(e){e.beginMouseMove=!1,e.approX=e.left,e.approY=e.top});n.isWinner()&&(n.hasWon||(n.props.onWin(),n.hasWon=!0)),n.setState({pieces:d})},n.isWinner=function(){for(var e=n.state.pieces,t=e[0][0].cluster,a=0;a<e.length;a++)for(var o=0;o<e[a].length;o++){if(0!==a||0!==o)if(t!==e[a][o].cluster)return!1}return!0},n.onFinishMove=function(e){for(var t=e.id,a=n.state.pieces,o=R(a,t),r=[],i=0;i<a.length;i++)for(var c=0;c<a[i].length;c++){var s=a[i][c];r[i]||(r[i]=[]),s.cluster===o.cluster&&s.approX!==s.left||s.approY!==s.top?r[i][c]=Object(g.a)({},s,{approX:s.left,approY:s.top,zIndex:++U}):r[i][c]=s}n.setState({pieces:r})},n.renderRows=function(){return x()(n.state.pieces)?null:n.state.pieces.map(function(e,t){return o.a.createElement(P,{key:t},e.map(function(e,t){return n.props.render({piece:e,onMove:n.onMove,onFinishMove:n.onFinishMove},t)}))})},n.state={width:null,height:null,pieces:[],clusters:{}},n.containerRef=o.a.createRef(),n.hasWon=!1,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"calculateScale",value:function(e,t){var n=window.innerHeight,a=window.innerWidth,o=1;return t>a&&(o=a/t),e*o>n&&(o=n/e),o-.2}},{key:"buildPattern",value:function(e){for(var t=[C.nub,C.hole],n=0;n<e.length;n++)for(var a=0;a<e[n].length;a++){var o=e[n][a],r=void 0;e[n+1]&&(r=e[n+1][a]);var i=e[n][a+1];if(i){var c=I()(t);o.pattern.right=c[0],o.neighbours.right.id=i.id,i.pattern.left=c[1],i.neighbours.left.id=o.id}if(r){var s=I()(t);o.pattern.bottom=s[0],o.neighbours.bottom.id=r.id,r.pattern.top=s[1],r.neighbours.top.id=o.id}}return e}},{key:"render",value:function(){return o.a.createElement("div",{ref:this.containerRef,className:this.props.className},o.a.createElement(y,{src:this.props.imageUrl,onUpdateDimensions:this.onUpdateDimensions}),this.renderRows())}}]),t}(a.Component),z=Object(f.a)(G)(S());function F(){var e=Object(h.a)(["\n  position: absolute;\n  cursor: pointer;\n  user-select: none;\n"]);return F=function(){return e},e}function A(e){var t=e.pageX,n=e.pageY;if(!t){if(!e.touches)return{pageX:null,pageY:null,success:!1};t=e.touches[0].pageX,n=e.touches[0].pageY}return{pageX:t,pageY:n,success:!0}}var B=function(e){function t(e){var n;Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).onDocumentMouseMove=function(e){n.props.piece.beginMouseMove&&n.onDrag(e)},n.onMouseDown=function(e){var t=A(e),a=t.pageX,o=t.pageY;t.success&&(n.props.piece.beginMouseMove=!0,n.x=a,n.y=o)},n.onMouseUp=function(e){var t=n.props.piece;n.props.piece.beginMouseMove=!1,n.props.onFinishMove({id:t.id})},n.onImageLoad=function(e){var t=n.props.piece,a=t.x,o=t.y,r=t.width,i=t.height,c=t.scale,s=t.pattern,l=n.canvasRef.current.getContext("2d");l.drawImage(e.target,a,o,r,i,0,0,r*c,i*c),l.globalCompositeOperation="destination-out",l.beginPath(),s.left===C.hole&&l.arc(r/12*c,i/2*c,i/6*c,0,2*Math.PI),l.stroke(),l.fill(),l.beginPath(),s.right===C.hole&&l.arc((r-r/12)*c,i/2*c,i/6*c,0,2*Math.PI),l.stroke(),l.fill(),l.beginPath(),s.top===C.hole&&l.arc(r/2*c,i/12*c,i/6*c,0,2*Math.PI),l.stroke(),l.fill(),l.beginPath(),s.bottom===C.hole&&l.arc(r/2*c,(i-i/12)*c,i/6*c,0,2*Math.PI),l.stroke(),l.fill(),n.drawNubs(e.target)},n.canvasRef=o.a.createRef();var a=n.props.piece.pattern;return n.nubCanvasRefs=Object.keys(a).filter(function(e){return a[e]===C.nub}).map(function(e){return{direction:e,ref:o.a.createRef()}}),n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(e){document.body.addEventListener("mousemove",this.onDocumentMouseMove),document.body.addEventListener("touchmove",this.onDocumentMouseMove),document.body.addEventListener("mouseup",this.onMouseUp),document.body.addEventListener("touchend",this.onMouseUp)}},{key:"componentWillUnmount",value:function(){document.body.removeEventListener("mousemove",this.onDocumentMouseMove),document.body.removeEventListener("touchmove",this.onDocumentMouseMove)}},{key:"onDrag",value:function(e){var t=A(e),n=t.pageX,a=t.pageY;if(t.success){var o=this.x-n,r=this.y-a;this.props.onMove({id:this.props.piece.id,deltaX:o,deltaY:r})}else this.props.piece.beginMouseMove=!1}},{key:"drawNubs",value:function(e){var t=this.props.piece,n=t.x,a=t.y,o=t.width,r=t.height,i=t.scale,c=t.pattern;this.nubCanvasRefs.forEach(function(t){var s=t.ref.current,l=s.getContext("2d");if("right"===t.direction&&c[t.direction]===C.nub){var u=o/3*i,p=r/3*i;s.height=p,s.width=u,s.style="position: absolute; top: ".concat(p,"px"),l.beginPath(),l.arc(u/4,p/2,p/2,0,2*Math.PI),l.clip(),u/=i,p/=i,l.drawImage(e,n+o,a+p,u,p,0,0,u*i,p*i)}if("left"===t.direction&&c[t.direction]===C.nub){var h=o/3*i,f=r/3*i;s.height=f,s.width=h,s.style="position: absolute; top: ".concat(f,"px; left: -").concat(h,"px"),l.beginPath(),l.arc(h/2+h/4,f/2,f/2,0,2*Math.PI),l.clip(),h/=i,f/=i,l.drawImage(e,n-h,a+f,h,f,0,0,h*i,f*i)}if("bottom"===t.direction&&c[t.direction]===C.nub){var d=o/3*i,v=r/3*i;s.height=v,s.width=d,s.style="position: absolute; top: ".concat(r*i,"px; right: ").concat(o*i/2-d/2,"px"),l.beginPath(),l.arc(d/2,v/4,v/2,0,2*Math.PI),l.clip(),d/=i,v/=i,l.drawImage(e,n+d,a+r,d,v,0,0,d*i,v*i)}if("top"===t.direction&&c[t.direction]===C.nub){var g=o/3*i,m=r/3*i;s.height=m,s.width=g,s.style="position: absolute; top: -".concat(m,"px; right: ").concat(o*i/2-g/2,"px"),l.beginPath(),l.arc(g/2,m/4+m/2,m/2,0,2*Math.PI),l.clip(),g/=i,m/=i,l.drawImage(e,n+g,a-m,g,m,0,0,g*i,m*i)}})}},{key:"render",value:function(){var e=this.props.piece,t=e.left,n=e.top,a=e.url,r=e.realWidth,i=e.realHeight,c=e.zIndex;return o.a.createElement("div",{className:this.props.className,onMouseDown:this.onMouseDown,style:{left:t,top:n,zIndex:c},onTouchStart:this.onMouseDown},o.a.createElement("canvas",{ref:this.canvasRef,width:r,height:i}),this.nubCanvasRefs.map(function(e,t){return o.a.createElement("canvas",{ref:e.ref,key:t})}),o.a.createElement(y,{src:a,onLoad:this.onImageLoad}))}}]),t}(a.Component),J=Object(f.a)(B)(F()),T=n(44),V=n(0),Z=(n(185),function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).onStartGame=function(t){e.setState({hasStartedGame:!0}),t.preventDefault()},e.handleUrlChange=function(t){e.setState({imageUrl:t.target.value})},e.handleDifficultyChange=function(t){e.setState({difficulty:t.target.value})},e.playAgain=function(){e.setState({hasStartedGame:!1})},e.onWin=function(){e.setState({hasWon:!0,hasStartedGame:!1})},e.state={imageUrl:"https://i.ytimg.com/vi/jMVwRZGH58I/maxresdefault.jpg",hasStartedGame:!1,difficulty:3,hasWon:!1},e}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement(T.a,null,o.a.createElement(V.b,{path:"/"},o.a.createElement(V.a,{to:"/start"})),o.a.createElement(V.d,null,o.a.createElement(V.b,{path:"/start"},o.a.createElement("div",{className:"start-game"},o.a.createElement("form",{onSubmit:this.onStartGame},o.a.createElement("label",null,"Picture URL:",o.a.createElement("input",{type:"text",value:this.state.imageUrl,onChange:this.handleUrlChange})),o.a.createElement("br",null),o.a.createElement("label",null,"Select difficulty:",o.a.createElement("select",{value:this.state.difficulty,onChange:this.handleDifficultyChange},o.a.createElement("option",{value:2},"2X2"),o.a.createElement("option",{value:3},"3X3"),o.a.createElement("option",{value:4},"4X4"),o.a.createElement("option",{value:6},"6X6"),o.a.createElement("option",{value:7},"8X8"))),o.a.createElement("br",null),o.a.createElement("button",null,"Start Game"))),this.state.hasStartedGame?o.a.createElement(V.a,{to:"/game"}):o.a.createElement(V.a,{to:"/start"})),o.a.createElement(V.b,{path:"/game"},o.a.createElement(v,null,o.a.createElement(z,{imageUrl:this.state.imageUrl,piecesX:this.state.difficulty,piecesY:this.state.difficulty,render:function(e,t){var n=e.piece,a=e.onMove,r=e.onFinishMove;return o.a.createElement(J,{key:t,piece:n,onMove:a,onFinishMove:r})},onWin:this.onWin})),this.state.hasWon?o.a.createElement(V.a,{to:"/end"}):null),o.a.createElement(V.b,{path:"/end"},o.a.createElement("div",{className:"end-game"},o.a.createElement("div",null,o.a.createElement("div",null,"Congragulations! You completed the puzzle."),o.a.createElement("div",{className:"play-again-link"},o.a.createElement(T.b,{onClick:this.playAgain,to:"/start"},"Play again"))))))))}}]),t}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(Z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},79:function(e,t,n){e.exports=n(189)},84:function(e,t,n){}},[[79,2,1]]]);
//# sourceMappingURL=main.58199246.chunk.js.map